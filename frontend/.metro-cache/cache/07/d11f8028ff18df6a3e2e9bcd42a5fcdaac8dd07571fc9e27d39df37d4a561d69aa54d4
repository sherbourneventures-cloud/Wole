{"dependencies":[{"name":"../AsyncStorageError.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":60,"index":75}}],"key":"eJw0iZFo8wG6BE399IdmtcIdg/M=","exportNames":["*"],"imports":1}},{"name":"./IndexedDBConnectionRegistry.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":76},"end":{"line":4,"column":56,"index":132}}],"key":"zfdvkDeZ0AeLCzNij1XDPaBsb+M=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _AsyncStorageErrorJs = require(_dependencyMap[0], \"../AsyncStorageError.js\");\n  var _IndexedDBConnectionRegistryJs = require(_dependencyMap[1], \"./IndexedDBConnectionRegistry.js\");\n  var registry = _interopDefault(_IndexedDBConnectionRegistryJs);\n  class IndexedDBStorage {\n    constructor(dbName) {\n      this.dbName = dbName;\n    }\n    getValues = async keys => {\n      try {\n        const db = await this.db();\n        const tx = db.transaction(registry.default.TableName, \"readonly\");\n        const store = tx.objectStore(registry.default.TableName);\n        const result = await Promise.all(keys.map(async key => {\n          const entry = await store.get(key);\n          return {\n            key,\n            value: entry ?? null\n          };\n        }));\n        await tx.done;\n        return result;\n      } catch (e) {\n        throw this.createError(e);\n      }\n    };\n    setValues = async values => {\n      try {\n        const db = await this.db();\n        const tx = db.transaction(registry.default.TableName, \"readwrite\");\n        const store = tx.objectStore(registry.default.TableName);\n        const result = await Promise.all(values.map(async entry => {\n          await store.put(entry.value, entry.key);\n          return {\n            key: entry.key,\n            value: entry.value\n          };\n        }));\n        await tx.done;\n        return result;\n      } catch (e) {\n        throw this.createError(e);\n      }\n    };\n    removeValues = async keys => {\n      try {\n        const db = await this.db();\n        const tx = db.transaction(registry.default.TableName, \"readwrite\");\n        const store = tx.objectStore(registry.default.TableName);\n        await Promise.all(keys.map(async key => {\n          await store.delete(key);\n        }));\n      } catch (e) {\n        throw this.createError(e);\n      }\n    };\n    clearStorage = async () => {\n      try {\n        const db = await this.db();\n        await db.clear(registry.default.TableName);\n      } catch (e) {\n        throw this.createError(e);\n      }\n    };\n    getKeys = async () => {\n      try {\n        const db = await this.db();\n        return await db.getAllKeys(registry.default.TableName);\n      } catch (e) {\n        throw this.createError(e);\n      }\n    };\n    db = () => registry.default.getOrCreate(this.dbName);\n    createError(e) {\n      if (e instanceof _AsyncStorageErrorJs.AsyncStorageError) {\n        return e;\n      }\n      return _AsyncStorageErrorJs.AsyncStorageError.jsError(e?.message ?? `IndexedDB error: ${e}`, _AsyncStorageErrorJs.AsyncStorageError.Type.WebStorageError);\n    }\n  }\n  var _default = IndexedDBStorage;\n});","lineCount":98,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13,"Object"],[4,8,1,13],[4,9,1,13,"defineProperty"],[4,23,1,13],[4,24,1,13,"exports"],[4,31,1,13],[5,4,1,13,"value"],[5,9,1,13],[6,2,1,13],[7,2,1,13],[7,11,1,13,"_interopDefault"],[7,27,1,13,"e"],[7,28,1,13],[8,4,1,13],[8,11,1,13,"e"],[8,12,1,13],[8,16,1,13,"e"],[8,17,1,13],[8,18,1,13,"__esModule"],[8,28,1,13],[8,31,1,13,"e"],[8,32,1,13],[9,6,1,13,"default"],[9,13,1,13],[9,15,1,13,"e"],[10,4,1,13],[11,2,1,13],[12,2,81,0,"Object"],[12,8,81,0],[12,9,81,0,"defineProperty"],[12,23,81,0],[12,24,81,0,"exports"],[12,31,81,0],[13,4,81,0,"enumerable"],[13,14,81,0],[14,4,81,0,"get"],[14,7,81,0],[14,18,81,0,"get"],[14,19,81,0],[15,6,81,0],[15,13,81,0,"_default"],[15,21,81,0],[16,4,81,0],[17,2,81,0],[18,2,3,0],[18,6,3,0,"_AsyncStorageErrorJs"],[18,26,3,0],[18,29,3,0,"require"],[18,36,3,0],[18,37,3,0,"_dependencyMap"],[18,51,3,0],[19,2,4,0],[19,6,4,0,"_IndexedDBConnectionRegistryJs"],[19,36,4,0],[19,39,4,0,"require"],[19,46,4,0],[19,47,4,0,"_dependencyMap"],[19,61,4,0],[20,2,4,0],[20,6,4,0,"registry"],[20,14,4,0],[20,17,4,0,"_interopDefault"],[20,32,4,0],[20,33,4,0,"_IndexedDBConnectionRegistryJs"],[20,63,4,0],[21,2,5,0],[21,8,5,6,"IndexedDBStorage"],[21,24,5,22],[21,25,5,23],[22,4,6,2,"constructor"],[22,15,6,13,"constructor"],[22,16,6,14,"dbName"],[22,22,6,20],[22,24,6,22],[23,6,7,4],[23,10,7,8],[23,11,7,9,"dbName"],[23,17,7,15],[23,20,7,18,"dbName"],[23,26,7,24],[24,4,8,2],[25,4,9,2,"getValues"],[25,13,9,11],[25,16,9,14],[25,22,9,20,"keys"],[25,26,9,24],[25,30,9,28],[26,6,10,4],[26,10,10,8],[27,8,11,6],[27,14,11,12,"db"],[27,16,11,14],[27,19,11,17],[27,25,11,23],[27,29,11,27],[27,30,11,28,"db"],[27,32,11,30],[27,33,11,31],[27,34,11,32],[28,8,12,6],[28,14,12,12,"tx"],[28,16,12,14],[28,19,12,17,"db"],[28,21,12,19],[28,22,12,20,"transaction"],[28,33,12,31],[28,34,12,32,"registry"],[28,42,12,40],[28,43,12,40,"default"],[28,50,12,40],[28,51,12,41,"TableName"],[28,60,12,50],[28,62,12,52],[28,72,12,62],[28,73,12,63],[29,8,13,6],[29,14,13,12,"store"],[29,19,13,17],[29,22,13,20,"tx"],[29,24,13,22],[29,25,13,23,"objectStore"],[29,36,13,34],[29,37,13,35,"registry"],[29,45,13,43],[29,46,13,43,"default"],[29,53,13,43],[29,54,13,44,"TableName"],[29,63,13,53],[29,64,13,54],[30,8,14,6],[30,14,14,12,"result"],[30,20,14,18],[30,23,14,21],[30,29,14,27,"Promise"],[30,36,14,34],[30,37,14,35,"all"],[30,40,14,38],[30,41,14,39,"keys"],[30,45,14,43],[30,46,14,44,"map"],[30,49,14,47],[30,50,14,48],[30,56,14,54,"key"],[30,59,14,57],[30,63,14,61],[31,10,15,8],[31,16,15,14,"entry"],[31,21,15,19],[31,24,15,22],[31,30,15,28,"store"],[31,35,15,33],[31,36,15,34,"get"],[31,39,15,37],[31,40,15,38,"key"],[31,43,15,41],[31,44,15,42],[32,10,16,8],[32,17,16,15],[33,12,17,10,"key"],[33,15,17,13],[34,12,18,10,"value"],[34,17,18,15],[34,19,18,17,"entry"],[34,24,18,22],[34,28,18,26],[35,10,19,8],[35,11,19,9],[36,8,20,6],[36,9,20,7],[36,10,20,8],[36,11,20,9],[37,8,21,6],[37,14,21,12,"tx"],[37,16,21,14],[37,17,21,15,"done"],[37,21,21,19],[38,8,22,6],[38,15,22,13,"result"],[38,21,22,19],[39,6,23,4],[39,7,23,5],[39,8,23,6],[39,15,23,13,"e"],[39,16,23,14],[39,18,23,16],[40,8,24,6],[40,14,24,12],[40,18,24,16],[40,19,24,17,"createError"],[40,30,24,28],[40,31,24,29,"e"],[40,32,24,30],[40,33,24,31],[41,6,25,4],[42,4,26,2],[42,5,26,3],[43,4,27,2,"setValues"],[43,13,27,11],[43,16,27,14],[43,22,27,20,"values"],[43,28,27,26],[43,32,27,30],[44,6,28,4],[44,10,28,8],[45,8,29,6],[45,14,29,12,"db"],[45,16,29,14],[45,19,29,17],[45,25,29,23],[45,29,29,27],[45,30,29,28,"db"],[45,32,29,30],[45,33,29,31],[45,34,29,32],[46,8,30,6],[46,14,30,12,"tx"],[46,16,30,14],[46,19,30,17,"db"],[46,21,30,19],[46,22,30,20,"transaction"],[46,33,30,31],[46,34,30,32,"registry"],[46,42,30,40],[46,43,30,40,"default"],[46,50,30,40],[46,51,30,41,"TableName"],[46,60,30,50],[46,62,30,52],[46,73,30,63],[46,74,30,64],[47,8,31,6],[47,14,31,12,"store"],[47,19,31,17],[47,22,31,20,"tx"],[47,24,31,22],[47,25,31,23,"objectStore"],[47,36,31,34],[47,37,31,35,"registry"],[47,45,31,43],[47,46,31,43,"default"],[47,53,31,43],[47,54,31,44,"TableName"],[47,63,31,53],[47,64,31,54],[48,8,32,6],[48,14,32,12,"result"],[48,20,32,18],[48,23,32,21],[48,29,32,27,"Promise"],[48,36,32,34],[48,37,32,35,"all"],[48,40,32,38],[48,41,32,39,"values"],[48,47,32,45],[48,48,32,46,"map"],[48,51,32,49],[48,52,32,50],[48,58,32,56,"entry"],[48,63,32,61],[48,67,32,65],[49,10,33,8],[49,16,33,14,"store"],[49,21,33,19],[49,22,33,20,"put"],[49,25,33,23],[49,26,33,24,"entry"],[49,31,33,29],[49,32,33,30,"value"],[49,37,33,35],[49,39,33,37,"entry"],[49,44,33,42],[49,45,33,43,"key"],[49,48,33,46],[49,49,33,47],[50,10,34,8],[50,17,34,15],[51,12,35,10,"key"],[51,15,35,13],[51,17,35,15,"entry"],[51,22,35,20],[51,23,35,21,"key"],[51,26,35,24],[52,12,36,10,"value"],[52,17,36,15],[52,19,36,17,"entry"],[52,24,36,22],[52,25,36,23,"value"],[53,10,37,8],[53,11,37,9],[54,8,38,6],[54,9,38,7],[54,10,38,8],[54,11,38,9],[55,8,39,6],[55,14,39,12,"tx"],[55,16,39,14],[55,17,39,15,"done"],[55,21,39,19],[56,8,40,6],[56,15,40,13,"result"],[56,21,40,19],[57,6,41,4],[57,7,41,5],[57,8,41,6],[57,15,41,13,"e"],[57,16,41,14],[57,18,41,16],[58,8,42,6],[58,14,42,12],[58,18,42,16],[58,19,42,17,"createError"],[58,30,42,28],[58,31,42,29,"e"],[58,32,42,30],[58,33,42,31],[59,6,43,4],[60,4,44,2],[60,5,44,3],[61,4,45,2,"removeValues"],[61,16,45,14],[61,19,45,17],[61,25,45,23,"keys"],[61,29,45,27],[61,33,45,31],[62,6,46,4],[62,10,46,8],[63,8,47,6],[63,14,47,12,"db"],[63,16,47,14],[63,19,47,17],[63,25,47,23],[63,29,47,27],[63,30,47,28,"db"],[63,32,47,30],[63,33,47,31],[63,34,47,32],[64,8,48,6],[64,14,48,12,"tx"],[64,16,48,14],[64,19,48,17,"db"],[64,21,48,19],[64,22,48,20,"transaction"],[64,33,48,31],[64,34,48,32,"registry"],[64,42,48,40],[64,43,48,40,"default"],[64,50,48,40],[64,51,48,41,"TableName"],[64,60,48,50],[64,62,48,52],[64,73,48,63],[64,74,48,64],[65,8,49,6],[65,14,49,12,"store"],[65,19,49,17],[65,22,49,20,"tx"],[65,24,49,22],[65,25,49,23,"objectStore"],[65,36,49,34],[65,37,49,35,"registry"],[65,45,49,43],[65,46,49,43,"default"],[65,53,49,43],[65,54,49,44,"TableName"],[65,63,49,53],[65,64,49,54],[66,8,50,6],[66,14,50,12,"Promise"],[66,21,50,19],[66,22,50,20,"all"],[66,25,50,23],[66,26,50,24,"keys"],[66,30,50,28],[66,31,50,29,"map"],[66,34,50,32],[66,35,50,33],[66,41,50,39,"key"],[66,44,50,42],[66,48,50,46],[67,10,51,8],[67,16,51,14,"store"],[67,21,51,19],[67,22,51,20,"delete"],[67,28,51,26],[67,29,51,27,"key"],[67,32,51,30],[67,33,51,31],[68,8,52,6],[68,9,52,7],[68,10,52,8],[68,11,52,9],[69,6,53,4],[69,7,53,5],[69,8,53,6],[69,15,53,13,"e"],[69,16,53,14],[69,18,53,16],[70,8,54,6],[70,14,54,12],[70,18,54,16],[70,19,54,17,"createError"],[70,30,54,28],[70,31,54,29,"e"],[70,32,54,30],[70,33,54,31],[71,6,55,4],[72,4,56,2],[72,5,56,3],[73,4,57,2,"clearStorage"],[73,16,57,14],[73,19,57,17],[73,25,57,17,"clearStorage"],[73,26,57,17],[73,31,57,29],[74,6,58,4],[74,10,58,8],[75,8,59,6],[75,14,59,12,"db"],[75,16,59,14],[75,19,59,17],[75,25,59,23],[75,29,59,27],[75,30,59,28,"db"],[75,32,59,30],[75,33,59,31],[75,34,59,32],[76,8,60,6],[76,14,60,12,"db"],[76,16,60,14],[76,17,60,15,"clear"],[76,22,60,20],[76,23,60,21,"registry"],[76,31,60,29],[76,32,60,29,"default"],[76,39,60,29],[76,40,60,30,"TableName"],[76,49,60,39],[76,50,60,40],[77,6,61,4],[77,7,61,5],[77,8,61,6],[77,15,61,13,"e"],[77,16,61,14],[77,18,61,16],[78,8,62,6],[78,14,62,12],[78,18,62,16],[78,19,62,17,"createError"],[78,30,62,28],[78,31,62,29,"e"],[78,32,62,30],[78,33,62,31],[79,6,63,4],[80,4,64,2],[80,5,64,3],[81,4,65,2,"getKeys"],[81,11,65,9],[81,14,65,12],[81,20,65,12,"getKeys"],[81,21,65,12],[81,26,65,24],[82,6,66,4],[82,10,66,8],[83,8,67,6],[83,14,67,12,"db"],[83,16,67,14],[83,19,67,17],[83,25,67,23],[83,29,67,27],[83,30,67,28,"db"],[83,32,67,30],[83,33,67,31],[83,34,67,32],[84,8,68,6],[84,15,68,13],[84,21,68,19,"db"],[84,23,68,21],[84,24,68,22,"getAllKeys"],[84,34,68,32],[84,35,68,33,"registry"],[84,43,68,41],[84,44,68,41,"default"],[84,51,68,41],[84,52,68,42,"TableName"],[84,61,68,51],[84,62,68,52],[85,6,69,4],[85,7,69,5],[85,8,69,6],[85,15,69,13,"e"],[85,16,69,14],[85,18,69,16],[86,8,70,6],[86,14,70,12],[86,18,70,16],[86,19,70,17,"createError"],[86,30,70,28],[86,31,70,29,"e"],[86,32,70,30],[86,33,70,31],[87,6,71,4],[88,4,72,2],[88,5,72,3],[89,4,73,2,"db"],[89,6,73,4],[89,9,73,7,"db"],[89,10,73,7],[89,15,73,13,"registry"],[89,23,73,21],[89,24,73,21,"default"],[89,31,73,21],[89,32,73,22,"getOrCreate"],[89,43,73,33],[89,44,73,34],[89,48,73,38],[89,49,73,39,"dbName"],[89,55,73,45],[89,56,73,46],[90,4,74,2,"createError"],[90,15,74,13,"createError"],[90,16,74,14,"e"],[90,17,74,15],[90,19,74,17],[91,6,75,4],[91,10,75,8,"e"],[91,11,75,9],[91,23,75,21,"AsyncStorageError"],[91,43,75,38],[91,44,75,38,"AsyncStorageError"],[91,61,75,38],[91,63,75,40],[92,8,76,6],[92,15,76,13,"e"],[92,16,76,14],[93,6,77,4],[94,6,78,4],[94,13,78,11,"AsyncStorageError"],[94,33,78,28],[94,34,78,28,"AsyncStorageError"],[94,51,78,28],[94,52,78,29,"jsError"],[94,59,78,36],[94,60,78,37,"e"],[94,61,78,38],[94,63,78,40,"message"],[94,70,78,47],[94,74,78,51],[94,94,78,71,"e"],[94,95,78,72],[94,97,78,74],[94,99,78,76,"AsyncStorageError"],[94,119,78,93],[94,120,78,93,"AsyncStorageError"],[94,137,78,93],[94,138,78,94,"Type"],[94,142,78,98],[94,143,78,99,"WebStorageError"],[94,158,78,114],[94,159,78,115],[95,4,79,2],[96,2,80,0],[97,2,81,0],[97,6,81,0,"_default"],[97,14,81,0],[97,17,81,15,"IndexedDBStorage"],[97,33,81,31],[98,0,81,32],[98,3]],"functionMap":{"names":["<global>","IndexedDBStorage","constructor","getValues","keys.map$argument_0","setValues","values.map$argument_0","removeValues","clearStorage","getKeys","db","createError"],"mappings":"AAA;ACI;ECC;GDE;cEC;gDCK;ODM;GFM;cIC;kDCK;ODM;GJM;iBMC;iCHK;OGE;GNI;iBOC;GPO;YQC;GRO;OSC,uCT;EUC;GVK;CDC"},"hasCjsExports":false},"type":"js/module"}]}